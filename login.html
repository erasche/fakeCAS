<html>
	<head>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js" integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA=" crossorigin="anonymous"></script>
		<style type="text/css">
			#service { font-family: monospace }
			.qq {
				text-decoration: none;
				color: white;
				border-radius: 4px;
				text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);

				background: rgb(28, 184, 65);
				padding: 0.45em;
			}
			.Absolute-Center {
				margin: auto;
				position: absolute;
				top: 0; left: 0; bottom: 0; right: 0;
			}
		</style>
	</head>
	<body style="background-image: url(pattern.svg);background-size: cover;display: flex; align-items: center; justify-content: center">
		<div style="width: 25em;background: #eeeeee;margin: auto;padding: 0; box-shadow: 2px 4px 5px 0px #aaa; border-radius: 1%;">
			<div style="background: #5d4fa0;; padding: 1.3em; color:white">
				<h1 style="text-align:center;margin:0;font-family: monospace">Simple CAS Server</h1>
			</div>
			<div style="padding: 1em; padding-bottom: 1.5em;">
				<div>
				<a id="login" href="#" class="qq" style="border-radius: 0px; border: 1px solid #138c30;display: none;text-align: center;padding-top:0.7em;padding-bottom:0.7em;">Login to <span id="service">unknown</span></a>
				</div>
				<div id="error" style="display: none">
					<div style="background: red; padding: 1em">
						<code>?service=...</code> url parameter could not be parsed
					</div>
				</div>
			</div>
		</div>

<script type="text/javascript">
var href = window.location.href;
var service = decodeURIComponent(href.substring(href.indexOf("login.html") + 19));

// From MDN
function getRandomArbitrary(min, max) {
	return Math.random() * (max - min) + min;
}

if(service){
	$("#service").text(service);
	$("#login").attr('href', service +'?ticket=ST-' + getRandomArbitrary(10000000000000000, 20000000000000000));
	// Show the login button
	$("#login").css('display', 'block');
} else {
	$("#error").css('display', '');
}
</script>
	</body>
</html>
