<html>
	<head>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js" integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA=" crossorigin="anonymous"></script>
		<style type="text/css">
			#service { font-family: monospace }
			.qq {
				text-decoration: none;
				color: white;
				border-radius: 4px;
				text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);

				background: rgb(28, 184, 65);
				padding: 0.45em;
			}
		</style>
	</head>
	<body>
		<h1>Dummy CAS Server</h1>
		<p>
		Hi, you're authenticating to <span id="service">unknown</span>
		</p>

		<a id="login" href="#" class="qq" style="display: none">Login as test@example.com</a>
		<p id="error" style="display: none">
		Error: no <code>?service=...</code> parameter provided (or unintelligible)
		</p>


<script type="text/javascript">
var href = window.location.href;
var service = decodeURIComponent(href.substring(href.indexOf("login.html") + 19));

// From MDN
function getRandomArbitrary(min, max) {
	return Math.random() * (max - min) + min;
}

if(service){
	$("#service").text(service);
	$("#login").attr('href', service +'?ticket=ST-' + getRandomArbitrary(10000000000000000, 20000000000000000));
	// Show the login button
	$("#login").css('display', '');
} else {
	$("#error").css('display', '');
}
</script>
	</body>
</html>
